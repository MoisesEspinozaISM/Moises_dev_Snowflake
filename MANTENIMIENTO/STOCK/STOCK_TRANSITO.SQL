SELECT * FROM DEV_SILVER_M.SUPPLY.SILVER_STOCK_TRANSITO; 

SELECT * FROM STAGING_RD_HT_GT.SAP.MSEG 
WHERE EBELN = '4500292249'
AND EBELP = '00010'
AND MATNR = '000000000000010164'    
;

SELECT
  MANDT,
  MBLNR,
  ZEILE,
  MATNR,
  TRIM(UPPER(BWART)) AS bwart_n,
  TRIM(UPPER(SHKZG)) AS shkzg_n,
  ABS(MENGE)         AS cantidad,
  CAST(MENGE AS STRING) AS cantidad_raw,
  /* === FLAG DE COHERENCIA DE SIGNO (misma l√≥gica que el modelo) === */
  CASE
    WHEN TRIM(UPPER(BWART)) IN ('641','351','313','303') AND TRIM(UPPER(SHKZG)) <> 'H' THEN 1
    WHEN TRIM(UPPER(BWART)) IN ('101','315','305')       AND TRIM(UPPER(SHKZG)) <> 'S' THEN 1
    WHEN TRIM(UPPER(BWART)) IN ('642','352','314','304') AND TRIM(UPPER(SHKZG)) <> 'S' THEN 1
    WHEN TRIM(UPPER(BWART)) IN ('102','316','306')       AND TRIM(UPPER(SHKZG)) <> 'H' THEN 1
    ELSE 0
  END AS flag_incoherencia_signo
FROM STAGING_RD_HT_GT.SAP.MSEG
WHERE LPAD(TO_VARCHAR(EBELN),10,'0') = '4500292249'
  AND LPAD(TO_VARCHAR(EBELP),5,'0')  = '00010'
  AND MATNR = '000000000000010164'
ORDER BY MBLNR, ZEILE;

SELECT MATNR, XCHPF, LENGTH(XCHPF) AS len
FROM STAGING_RD_HT_GT.SAP.MARA
WHERE MATNR = '000000000000010164';

SELECT DISTINCT FECHA_CORTE FROM TEST_SILVER.SUPPLY.SILVER_STOCK_ALMACEN_CARIBE
WHERE ID_PAIS = 'DO'
ORDER BY FECHA_CORTE DESC;

CREATE TABLE  DEV_SILVER_M.SUPPLY.TEST_SILVER_STOCK_ALMACEN_BKP AS
SELECT * FROM TEST_SILVER.SUPPLY.SILVER_STOCK_ALMACEN_CARIBE
; 

SELECT COUNT(*) FROM DEV_SILVER_M.SUPPLY.TEST_SILVER_STOCK_ALMACEN_BKP
;
-- 41 060 523

SELECT * FROM TEST_SILVER.SUPPLY.SILVER_STOCK_TRANSITO 
WHERE CANTIDAD_RECIBIDA <> 0; 

SELECT * FROM TEST_SILVER.SUPPLY.SILVER_STOCK_ALMACEN
WHERE ID_PAIS = 'PE'
LIMIT 100; 

SELECT DISTINCT EINME FROM STAGING_RD_HT_GT.SAP.MARD;

-- AGREGAR NO LIBRE 
SELECT DISTINCT IDFECHA FROM STAGING_PE_CH.SQL_FABRIC.STOCK 
WHERE ENTRASLADO <> 0 ;

SELECT * FROM TEST_SILVER.SUPPLY.SILVER_MAESTRO_ALMACEN LIMIT 100; 


