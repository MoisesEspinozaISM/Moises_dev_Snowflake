SELECT DISTINCT REGION FROM DEV_BRONZE_M.COMERCIAL.CTE_VENTA_NETA_PE_CH LIMIT 19; 

SELECT * FROM DEV_BRONZE_M.COMERCIAL.CTE_VENTA_NETA_PE_CH 
WHERE REGION IS NULL; 

SELECT 
REGION, 
PERIODO,
SUM(LITROS_VENDIDOS) 
FROM DEV_BRONZE_M.COMERCIAL.CTE_VENTA_NETA_PE_CH
GROUP BY REGION, PERIODO
;

//////////////////// CAPA BRONZE - VENTA PE - CH 
SELECT *
FROM (
    SELECT 
        REGION,
        PERIODO,
        LITROS_VENDIDOS
    FROM DEV_BRONZE_M.COMERCIAL.CTE_VENTA_NETA_PE_CH
    WHERE PERIODO >= '202501'
)
PIVOT(
    SUM(LITROS_VENDIDOS)
    FOR PERIODO IN (202501, 202502, 202503, 202504, 202505, 202506, 202507, 202508, 202509, 202510, 202511, 202512)
)
ORDER BY REGION DESC;

/////////////////// CAPA SILVER  - VENTA NETA 

SELECT *
FROM (
    SELECT 
        REGION,
        PERIODO,
        LITROS_VENDIDOS
    FROM DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP
    WHERE PERIODO >= '202501'
    AND ID_PAIS IN ('PE', 'CH')
    AND REGION <> 'NA'
)
PIVOT(
    SUM(LITROS_VENDIDOS)
    FOR PERIODO IN (202501, 202502, 202503, 202504, 202505, 202506, 202507, 202508, 202509, 202510, 202511, 202512)
)
ORDER BY REGION DESC;


///////////////// VALIDANDO ESTE BUG 

    SELECT *
    FROM DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP
    WHERE PERIODO >= '202501'
    AND ID_PAIS IN ('PE', 'CH')
    AND REGION = 'NA'

    ; 

    SELECT * FROM STAGING_PE_CH.SQL_FABRIC.CLIENTE 
    WHERE IDCLIENTE = '2020-27699'

; 
SELECT * FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_PAIS IN ('PE', 'CH')
LIMIT 10; 
   
;
 /////////////////// CAPA SILVER  - VENTA NETA  - FINAL FINALIZIMO ///////////// 
SELECT *
FROM (
    SELECT 
        REGION,
        PERIODO,
        LITROS_VENDIDOS
    FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
    WHERE PERIODO >= '202501'
    AND ID_PAIS IN ('PE', 'CH')
    AND REGION <> 'NA'
)
PIVOT(
    SUM(LITROS_VENDIDOS)
    FOR PERIODO IN (202501, 202502, 202503, 202504, 202505, 202506, 202507, 202508, 202509, 202510, 202511, 202512)
)
ORDER BY REGION DESC;


SELECT 
    LISTAGG(DISTINCT '''' || PERIODO || '''', ',') 
        WITHIN GROUP (ORDER BY PERIODO) AS lista_periodos
FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP