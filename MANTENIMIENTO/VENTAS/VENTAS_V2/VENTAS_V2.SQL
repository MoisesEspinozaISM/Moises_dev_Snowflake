SELECT COUNT(*) FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
; 
-- 258 184 025 

SELECT COUNT(*) FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP_V2
; 
-- 258 184 025

SELECT SUM(LITROS_VENDIDOS_NETOS) FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP;
-- 5 125 796 189.46

SELECT SUM(LITROS_VENDIDOS_NETOS) FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP_V2;
-- 5 125 795 364.16 !!!!!!!!!!!!!!!! TENEMOS MENOS 

/////////////// COMPARACION GENERAL DE DATOS 
SELECT 
SUM(LITROS_VENDIDOS_NETOS), 
SUM(LITROS_BONIFICADOS), 
SUM(LITROS_RECHAZADOS), 
SUM(LITROS_VENDIDOS), 
SUM(LITROS_ORIGEN_NETO), 
SUM(LITROS_ORIGEN_RECHAZO),
SUM(LITROS_ORIGEN_BONI), 
SUM(LITROS_ORIGEN_VENTA),
ID_PAIS, 
PERIODO
FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP_V2
GROUP BY ID_PAIS, PERIODO
ORDER BY ID_PAIS, PERIODO
; 

///////////////////// AGREGANDO MAS CAMPOS A BRASIL /////////////////// 

SELECT COUNT(*) FROM TEST_BRONZE.COMERCIAL.VENTAS_NETA_BR; 
-- 10 810 793

SELECT COUNT(*) FROM DEV_BRONZE_M.COMERCIAL.VENTAS_NETA_BR;
-- 10 810 794 - OKJ 
SELECT SUM(LITROS_VENDIDOS_NETOS), 
SUM(LITROS_BONIFICADOS),
SUM(LITROS_RECHAZADOS),
SUM(MONTO_VENTA_NETA), 
ID_SOCIEDAD_ORIGEN, 
PERIODO
FROM TEST_BRONZE.COMERCIAL.VENTAS_NETA_BR
GROUP BY ID_SOCIEDAD_ORIGEN, PERIODO
ORDER BY ID_SOCIEDAD_ORIGEN, PERIODO
;

SELECT SUM(LITROS_VENDIDOS_NETOS), 
SUM(LITROS_BONIFICADOS),
SUM(LITROS_RECHAZADOS),
SUM(MONTO_VENTA_NETA), 
ID_SOCIEDAD_ORIGEN, 
PERIODO
FROM DEV_BRONZE_M.COMERCIAL.VENTAS_NETA_BR
GROUP BY ID_SOCIEDAD_ORIGEN, PERIODO
ORDER BY ID_SOCIEDAD_ORIGEN, PERIODO
;




SELECT * FROM PROD_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_PAIS = 'DO'
AND ID_CANAL = 'E0'
AND PERIODO >= '202501'
LIMIT 1000; 
-- MONTO VENTA NETA = 7197.12
-- MONTO VENTA BASE = 7197.12
9094072065

; 
SELECT * FROM STAGING_RD_HT_GT.SAP.VBRP
WHERE VBELN = '9094072065';
--AND MATNR = '000000000000001261'; 

SELECT 
VBRK.waerk as moneda_documento, 
VBRK.CMWAE as moneda_pais,
VBRK.KURRF as conversion, 
VBRP.NETWR as monto_neto_moneda_documento,
(VBRP.NETWR * VBRK.KURRF) AS monto_neto_moneda_pais, 
VBRP.KZWI1 AS VENTA_SIN_IMPUESTOS, 
(VBRP.KZWI1 * VBRK.KURRF) AS VENTA_SIN_IMPUESTO_MONEDA_LOCAL
FROM STAGING_RD_HT_GT.SAP.VBRK VBRK
INNER JOIN STAGING_RD_HT_GT.SAP.VBRP VBRP 
ON VBRP.VBELN = VBRK.VBELN
Where VBRK.waerk = 'USD'
AND VBRK.BUKRS = '1000'
limit 2000
-- WAERK - MONEDA DEL DOCUMENTO 
;

MONTO_VENTA_NETA (moneda_local) 
= SI ES"DOP" = NETWR
  SI NO  (VBRP.NETWR * VBRK.KURRF)
; 

select DISTINCT waerk from STAGING_RD_HT_GT.SAP.VBRK
WHERE BUKRS = '1000'
; 

SELECT * FROM STAGING_RD_HT_GT.SAP.VBRK LIMIT 100; 

MONOTO_VENTA_BRUTA : lISTA DE PRECIO ACTUAL * VENTA UNIDADES 
;

SELECT COUNT(*) FROM DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP; 
--258 884 686

SELECT COUNT(*) FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP;
--258 884 793

SELECT 
SUM(LITROS_VENDIDOS), 
SUM(LITROS_RECHAZADOS),
SUM(LITROS_VENDIDOS_NETOS),
SUM(LITROS_BONIFICADOS),
SUM(LITROS_ORIGEN_VENTA),
SUM(LITROS_ORIGEN_RECHAZO), 
SUM(LITROS_ORIGEN_NETO),
SUM(LITROS_ORIGEN_BONI),
ID_PAIS,
PERIODO
FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
GROUP BY ID_PAIS, PERIODO
ORDER BY ID_PAIS, PERIODO
; 

SELECT 
SUM(LITROS_VENDIDOS), 
SUM(LITROS_RECHAZADOS),
SUM(LITROS_VENDIDOS_NETOS),
SUM(LITROS_BONIFICADOS),
SUM(LITROS_ORIGEN_VENTA),
SUM(LITROS_ORIGEN_RECHAZO), 
SUM(LITROS_ORIGEN_NETO),
SUM(LITROS_ORIGEN_BONI),
ID_PAIS,
PERIODO, 
FECHA
FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE FECHA BETWEEN '2025-10-01' AND '2025-11-11'
GROUP BY ID_PAIS, PERIODO, FECHA
ORDER BY ID_PAIS, PERIODO, FECHA ASC
;

SELECT 
SUM(LITROS_VENDIDOS), 
ID_FACTURA_VENTA,
SUM(LITROS_RECHAZADOS),
ID_FACTURA_RECHAZO,
SUM(LITROS_VENDIDOS_NETOS),
SUM(LITROS_BONIFICADOS),
SUM(LITROS_ORIGEN_VENTA),
SUM(LITROS_ORIGEN_RECHAZO), 
SUM(LITROS_ORIGEN_NETO),
SUM(LITROS_ORIGEN_BONI),
ID_PAIS,
ID_SKU_ORIGEN, 
PERIODO, 
FECHA
FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE FECHA = '2025-10-10' 
GROUP BY ID_PAIS, PERIODO, FECHA, ID_SKU_ORIGEN, ID_FACTURA_VENTA, ID_FACTURA_RECHAZO
ORDER BY ID_PAIS, PERIODO, FECHA, ID_SKU_ORIGEN ASC
;

SELECT 
SUM(LITROS_VENDIDOS), 
SUM(LITROS_RECHAZADOS),
SUM(LITROS_VENDIDOS_NETOS),
SUM(LITROS_BONIFICADOS),
SUM(LITROS_ORIGEN_VENTA),
SUM(LITROS_ORIGEN_RECHAZO), 
SUM(LITROS_ORIGEN_NETO),
SUM(LITROS_ORIGEN_BONI),
ID_PAIS,
PERIODO
FROM DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP
GROUP BY ID_PAIS, PERIODO
ORDER BY ID_PAIS, PERIODO
; 

SELECT 
SUM(LITROS_VENDIDOS), 
SUM(LITROS_RECHAZADOS),
SUM(LITROS_VENDIDOS_NETOS),
SUM(LITROS_BONIFICADOS),
SUM(LITROS_ORIGEN_VENTA),
SUM(LITROS_ORIGEN_RECHAZO), 
SUM(LITROS_ORIGEN_NETO),
SUM(LITROS_ORIGEN_BONI),
ID_PAIS,
PERIODO, 
FECHA
FROM DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE FECHA BETWEEN '2025-10-01' AND '2025-11-11'
GROUP BY ID_PAIS, PERIODO, FECHA
ORDER BY ID_PAIS, PERIODO, FECHA ASC
;

SELECT * FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP TEST
LEFT JOIN DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP DEV
ON TEST.ID_PEDIDO = DEV.ID_PEDIDO
AND TEST.ID_ENTREGA = DEV.ID_ENTREGA
AND TEST.ID_CLIENTE_ORIGEN = DEV.ID_CLIENTE_ORIGEN
AND TEST.ID_CANAL = DEV.ID_CANAL
AND TEST.ID_SOCIEDAD_ORIGEN = DEV.ID_SOCIEDAD_ORIGEN
AND TEST.ID_CENTRO_ORIGEN = DEV.ID_CENTRO_ORIGEN
AND TEST.ID_SKU_ORIGEN = DEV.ID_SKU_ORIGEN
AND TEST.ID_VENDEDOR = DEV.ID_VENDEDOR 
AND TEST.ID_DISTRIBUIDOR = DEV.ID_DISTRIBUIDOR
AND TEST.ID_RUTA = DEV.ID_RUTA 
AND TEST.ID_FACTURA_VENTA = DEV.ID_FACTURA_VENTA 
AND TEST.ID_FACTURA_RECHAZO = DEV.ID_FACTURA_RECHAZO
AND TEST.FECHA = DEV.FECHA
WHERE DEV.ID_FACTURA_VENTA IS NULL

; 

SELECT * FROM DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_FACTURA_VENTA = '0951854132'
AND ID_FACTURA_RECHAZO = '0951854686'
-- 60 UNIDADES VENDIDAS 
; 

SELECT * FROM DEV_BRONZE_M.COMERCIAL.RECHAZO_VENTAS_GTM
WHERE ID_FACTURA_RECHAZO = '0951854686'
;
SELECT * FROM STAGING_RD_HT_GT.SAP.VBRP
WHERE VBELN = '0951854686';

SELECT * FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_FACTURA_VENTA = '0951854132'
AND ID_FACTURA_RECHAZO = '0951854686'
;


SELECT * FROM TEST_BRONZE.COMERCIAL.RECHAZO_VENTAS_GTM
WHERE ID_FACTURA_RECHAZO = '0951854686'
;

SELECT SUM(VOLUMEN_VENTA), idfecontabilizacion FROM STAGING_PE_CH.SQL_FABRIC.VENTA
group by idFeContabilizacion
order by idFeContabilizacion asc; 

SELECT SUM(VOLUMEN_VENTA) FROM STAGING_PE_CH.SQL_FABRIC.VENTA; 
--1 437 977 036.32523

SELECT SUM(VOLUMEN_VENTA) FROM DEV_BRONZE_M.COMERCIAL.STG_VENTA; 
-- 1 437 977 036.32523
SELECT SUM(LITROS_VENDIDOS) FROM DEV_BRONZE_M.COMERCIAL.CTE_VENTA_NETA_PE_CH; 
-- 1 437 977 033.3739

SELECT SUM(LITROS_VENDIDOS) FROM DEV_BRONZE_M.COMERCIAL.VENTA_NETA_PE_CH; 
-- 1 437 977 034.692034
SELECT SUM(LITROS_VENDIDOS) FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_PAIS = 'PE'; 
--1 383 776 256.93
DESC TABLE DEV_BRONZE_M.COMERCIAL.CTE_VENTA_NETA_PE_CH;
SHOW COLUMNS IN DEV_BRONZE_M.COMERCIAL.STG_VENTA;


SELECT SUM(QTY_BONIF) FROM DEV_BRONZE_M.COMERCIAL.CTE_VENTAS_BR;


SELECT 
SUM(LITROS_VENDIDOS), 
SUM(LITROS_RECHAZADOS),
SUM(LITROS_VENDIDOS_NETOS), 
SUM(LITROS_BONIFICADOS),
PERIODO
FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_PAIS = 'BR'
AND PERIODO >= '202501'
AND SVR NOT IN (990, 991)
GROUP BY PERIODO 
ORDER BY PERIODO ASC 
; 

SELECT DISTINCT SVR FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_PAIS = 'BR'
ORDER BY SVR ASC;

SELECT DISTINCT SVR FROM STAGING_BR.ORACLE.VIEW_VENDASBR_ML
WHERE D_SITUACAO = 'NORMAL'
AND D_NEGOCIO IN ('NEGOCIO 1', 'NEGOCIO 2', 'NEGOCIO 3')
ORDER BY SVR ASC
; 

SELECT DISTINCT D_SITUACAO FROM STAGING_BR.ORACLE.VIEW_VENDASBR_ML; 

SELECT DISTINCT SVR FROM STAGING_BR.ORACLE.VIEW_VENDASBR_ML
WHERE D_SITUACAO = 'CANCELADA'; 

SELECT * FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_FACTURA_VENTA = '0951786129' ; 

SELECT * FROM STAGING_RD_HT_GT.SAP.ZFIT_HEAD_LIQR
WHERE VBELN_VF = '0951786129'
; 

SELECT * FROM STAGING_RD_HT_GT.SAP.VBRK
WHERE VBELN = '1001814942'
;

SELECT * FROM 
;
Select 
periodo,
sum(litros_vendidos_netos) as volumen_neto,
id_pais
from TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
where ID_PAIS IN ('PE','CH')
and periodo >='202501'
group by id_pais,periodo
order by id_pais,periodo asc;

			SELECT *
FROM TABLE(UTILS.COALESCE.TEST_ULTIMAS_FECHAS(
  '"PROD_BRONZE"."COMERCIAL"."STG_VIEW_VENDASBR_ML"', 
  'SALESDATE', 
  2,   
  TRUE 
))