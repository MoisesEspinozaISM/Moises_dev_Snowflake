SELECT 
ID_PAIS, 
PERIODO,
FECHA,
SUM(LITROS_VENDIDOS_NETOS) AS LITROS_TOTALES
FROM PROD_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE PERIODO = '202510' --AND '202505'
GROUP BY ID_PAIS, PERIODO , FECHA
ORDER BY ID_PAIS, PERIODO, FECHA ASC; 

SELECT * FROM TEST_SILVER.COMERCIAL.SILVER_MAESTRO_PRODUCTO
WHERE ID_TIPO_MATERIAL = 'ZFER'
;

//////////////// DEV - VALIDACION LITROS DO ///////////////////////// 

SELECT * FROM DEV_SILVER_M.COMERCIAL.SILVER_VENTA_NETA_CORP
; 

SELECT * FROM DEV_SILVER_M.COMERCIAL.SILVER_MAESTRO_PRODUCTO
WHERE ID_TIPO_MATERIAL IN ('ZFER', 'ZHAW')
AND ID_PAIS = 'DO'
;

SELECT
    --'ejecutado' AS tipo,
    id_canal,
    CAST(v.PERIODO / 100 AS INT) AS year,
    CAST(v.PERIODO AS INT) % 100 AS periodo,
    SUM(v.LITROS_VENDIDOS_NETOS) AS litros_netos,
    SUM(v.LITROS_VENDIDOS) AS litros,
    SUM(v.LITROS_ORIGEN_VENTA) AS litros_origen,
    sum(v.litros_origen_rechazo) AS litros_origen_rechazo,
    SUM(v.LITROS_ORIGEN_NETO) AS litros_origen_neto
FROM TEST_SILVER .COMERCIAL.SILVER_VENTA_NETA_CORP v
/*INNER JOIN PROD_SILVER.COMERCIAL.SILVER_MAESTRO_PRODUCTO p
    ON v.ID_SKU_ORIGEN = p.ID_SKU_ORIGEN
    AND v.ID_SOCIEDAD = p.ID_SOCIEDAD
INNER JOIN TEST_SILVER.COMERCIAL.SILVER_REGIONES_CORP r
    ON v.ID_CENTRO_ORIGEN = r.CENTRO
    AND v.ID_CANAL = CAST(r.CANAL AS STRING)
    AND UPPER(p.CATEGORIA_CORTEX) = UPPER(r.CATEGORIA)
    AND UPPER(p.MARCA_CORTEX) = UPPER(r.MARCA)*/
WHERE v.ID_SOCIEDAD = 'DO-1000' and id_canal in ('K0','10','20','30','40','80') and year = 2025
GROUP BY
    year,
    periodo,
    id_canal
ORDER BY 
    id_canal,
    year,
    periodo;


//////////////// VALIDNADO SAP ///////////////////////// 
SELECT 
"STG_VBRK"."VTWEG" AS "ID_CANAL",
TO_CHAR(
    TO_DATE("STG_VBRK"."FKDAT", 'YYYY-MM-DD'),
    'YYYY'
  ) AS "YEAR",
TO_CHAR(
    TO_DATE("STG_VBRK"."FKDAT", 'YYYY-MM-DD'),
    'YYYYMM'
  ) AS "PERIODO",
(SUM(STG_VBRP.VOLUM))/1000 AS VOLUM_LITROS,
FROM "TEST_BRONZE"."COMERCIAL"."STG_VBRK" STG_VBRK
  INNER JOIN STAGING_RD_HT_GT.SAP.VBRP STG_VBRP ON STG_VBRK."VBELN" = STG_VBRP."VBELN"
  INNER JOIN (
    SELECT *
    FROM (
        SELECT DISTINCT VBELN_VF,
          MAX(DATEN),
          MIN(AUGRU) AS AUGRU
        FROM "TEST_BRONZE"."COMERCIAL"."STG_ZFIT_HEAD_LIQR"
        WHERE "NETWR_F" <> 0
        GROUP BY VBELN_VF
      ) AS zfit_sub
  ) AS STG_ZFIT_HEAD_LIQR ON "STG_VBRK"."VBELN" = "STG_ZFIT_HEAD_LIQR"."VBELN_VF"
  LEFT JOIN "TEST_BRONZE"."COMERCIAL"."STG_TVAUT" STG_TVAUT ON "STG_ZFIT_HEAD_LIQR"."AUGRU" = "STG_TVAUT"."AUGRU"
  LEFT JOIN "TEST_BRONZE"."COMERCIAL"."ID_VENDEDORES_DO" ID_VENDEDORES_DO ON STG_VBRK."VBELN" = ID_VENDEDORES_DO."VBELN"
  LEFT JOIN "TEST_BRONZE"."COMERCIAL"."STG_LIKP" STG_LIKP ON STG_VBRP."VGBEL" = STG_LIKP."VBELN"
WHERE STG_VBRK."BUKRS" = '1000'
  AND STG_VBRP."PSTYV" IN ('TAN', 'ZTAD', 'TAQ', 'KEN', 'ZBTA', 'ZTND')
  AND "STG_VBRK"."VTWEG" IN ('K0','10','20','30','40','80')
--   AND "STG_VBRK"."FKART" NOT IN ('S1', 'S2')
--   AND "STG_VBRK"."FKSTO" <> 'X'
  AND "STG_VBRK"."VBTYP" = 'M'
  AND TO_CHAR(
    TO_DATE("STG_VBRK"."FKDAT", 'YYYY-MM-DD'),
    'YYYYMM'
  ) >= '202501'
GROUP BY "STG_VBRK"."VTWEG", TO_CHAR(
    TO_DATE("STG_VBRK"."FKDAT", 'YYYY-MM-DD'),
    'YYYY'
  ), TO_CHAR(
    TO_DATE("STG_VBRK"."FKDAT", 'YYYY-MM-DD'),
    'YYYYMM'
  )
ORDER BY "STG_VBRK"."VTWEG", TO_CHAR(
    TO_DATE("STG_VBRK"."FKDAT", 'YYYY-MM-DD'),
    'YYYY'
  ), TO_CHAR(
    TO_DATE("STG_VBRK"."FKDAT", 'YYYY-MM-DD'),
    'YYYYMM'
  )
  ; 


SELECT "ID_SALESDAILY", COUNT(*)
FROM "TEST_GOLD"."COMERCIAL"."GOLD_SALESDAILY_DO_CORP" 
GROUP BY "ID_SALESDAILY"
HAVING COUNT(*) > 1
;

SELECT *
FROM "TEST_GOLD"."COMERCIAL"."GOLD_SALESDAILY_DO_CORP" 
where  ID_SALESDAILY = '0000600284-1424-30-1010-2025-10-04-1293588117-110362-1213770546'
;

/////////////////// VALIDACION DE SALES_DAYLY DO ///////////////////////// 

SELECT "ID_SALESDAILY", COUNT(*)
FROM "TEST_GOLD"."COMERCIAL"."GOLD_SALESDAILY_DO_CORP" 
GROUP BY "ID_SALESDAILY"
HAVING COUNT(*) > 1; 

SELECT *
FROM "TEST_GOLD"."COMERCIAL"."GOLD_SALESDAILY_DO_CORP" 
WHERE "ID_SALESDAILY" = '0000600284-1424-30-1010-2025-10-04-1293588117-110362-1213770546'
; 

SELECT * FROM STAGING_RD_HT_GT.SAP.ZFIT_HEAD_LIQR 
WHERE VBELN_VF = '1293588117'; 

SELECT * FROM TEST_SILVER.COMERCIAL.SILVER_VENTA_NETA_CORP
WHERE ID_FACTURA_VENTA = '1293588117'
AND ID_SKU_ORIGEN = '000000000000001424'
;
-- FACTURA RECHAZO 1 = '1293589159'  -- NO ESTA EN ZFIT_HEAD_LIQR
-- FACTURA RECHAZO 2 = '1293602095'
SELECT * FROM STAGING_RD_HT_GT.SAP.ZFIT_HEAD_LIQR 
WHERE VBELN_VFR = '1293602095'; 


SELECT * FROM TEST_BRONZE.COMERCIAL.VENTAS_DO
WHERE ID_FACTURA = '1293588117'
AND ID_SKU_ORIGEN = '000000000000001424'
;


SELECT * FROM TEST_BRONZE.COMERCIAL.RECHAZO_VENTAS_DO
WHERE ID_FACTURA_VENTA = '1293588117'
AND ID_SKU_ORIGEN = '000000000000001424'
;

SELECT * FROM TEST_BRONZE.COMERCIAL.VENTA_NETA_CORP_CARIBE
WHERE ID_FACTURA_VENTA = '1293588117'
AND ID_SKU_ORIGEN = '000000000000001424'
;
