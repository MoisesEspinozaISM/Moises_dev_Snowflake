/////////////////////////// LIKP /////////////////////////////////////////
SELECT
  YEAR(TO_DATE(ERDAT, 'YYYY-MM-DD'))  AS anio,
  MONTH(TO_DATE(ERDAT, 'YYYY-MM-DD')) AS mes,
  COUNT(*)                          AS registros
FROM STAGING_RD_HT_GT.SAP.LIKP
WHERE TO_DATE(ERDAT, 'YYYY-MM-DD') >= TO_DATE('2025-01-01', 'YYYY-MM-DD')
  AND TO_DATE(ERDAT, 'YYYY-MM-DD') <  TO_DATE('2025-12-31', 'YYYY-MM-DD')
GROUP BY
  YEAR(TO_DATE(ERDAT, 'YYYY-MM-DD')),
  MONTH(TO_DATE(ERDAT, 'YYYY-MM-DD'))
ORDER BY anio, mes;

SELECT COUNT(*) FROM STAGING_RD_HT_GT.SAP.LIKP
WHERE ERDAT >= '2025-01-01'
;
-- 5 813 839
-- 5 817 607
/////////////////////////// VBRK /////////////////////////////////////////
SELECT
  YEAR(TO_DATE(FKDAT, 'YYYY-MM-DD'))  AS anio,
  MONTH(TO_DATE(FKDAT, 'YYYY-MM-DD')) AS mes,
  FKDAT AS FKDAT,
  COUNT(*)                          AS registros
FROM STAGING_RD_HT_GT.SAP.VBRK
WHERE TO_DATE(FKDAT, 'YYYY-MM-DD') >= TO_DATE('2025-05-01', 'YYYY-MM-DD')
  AND TO_DATE(FKDAT, 'YYYY-MM-DD') <  TO_DATE('2025-12-31', 'YYYY-MM-DD')
GROUP BY
  YEAR(TO_DATE(FKDAT, 'YYYY-MM-DD')),
  MONTH(TO_DATE(FKDAT, 'YYYY-MM-DD')),
  FKDAT
ORDER BY anio, mes, FKDAT;

SELECT ERDAT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.VBRK
WHERE ERDAT BETWEEN '2025-01-01' AND '2025-12-31'
GROUP BY ERDAT
ORDER BY ERDAT ASC;

SELECT ERDAT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.VBRP
WHERE ERDAT BETWEEN '2025-01-01' AND '2025-12-31'
GROUP BY ERDAT
ORDER BY ERDAT ASC;

/////////////////////////// VBRP /////////////////////////////////////////
SELECT
  YEAR(TO_DATE(ERDAT, 'YYYY-MM-DD'))  AS anio,
  MONTH(TO_DATE(ERDAT, 'YYYY-MM-DD')) AS mes,
  COUNT(*)                          AS registros
FROM STAGING_RD_HT_GT.SAP.VBRP
WHERE TO_DATE(ERDAT, 'YYYY-MM-DD') >= TO_DATE('2024-01-01', 'YYYY-MM-DD')
  AND TO_DATE(ERDAT, 'YYYY-MM-DD') <  TO_DATE('2025-12-31', 'YYYY-MM-DD')
GROUP BY
  YEAR(TO_DATE(ERDAT, 'YYYY-MM-DD')),
  MONTH(TO_DATE(ERDAT, 'YYYY-MM-DD'))
ORDER BY anio, mes;

/////////////////////////// ZFIT_HEAD_LIQR /////////////////////////////////////////
SELECT
  YEAR(TO_DATE(DATEN, 'YYYY-MM-DD'))  AS anio,
  MONTH(TO_DATE(DATEN, 'YYYY-MM-DD')) AS mes,
  COUNT(*)                          AS registros
FROM STAGING_RD_HT_GT.SAP.ZFIT_HEAD_LIQR
WHERE TO_DATE(DATEN, 'YYYY-MM-DD') >= TO_DATE('2024-01-01', 'YYYY-MM-DD')
  AND TO_DATE(DATEN, 'YYYY-MM-DD') <  TO_DATE('2025-12-31', 'YYYY-MM-DD')
GROUP BY
  YEAR(TO_DATE(DATEN, 'YYYY-MM-DD')),
  MONTH(TO_DATE(DATEN, 'YYYY-MM-DD'))
ORDER BY anio, mes;

DELETE FROM STAGING_RD_HT_GT.SAP.ZFIT_HEAD_LIQR
WHERE DATEN >= '2025-06-01'

; 

SELECT * FROM DEV_SILVER_MJ.COMERCIAL.HISTORICO_KPIS_CATEGORIA_MARCA;


///////////////////////// COBK /////////////////////////////////////////

SELECT
  YEAR(TO_DATE(bldat, 'YYYY-MM-DD'))  AS anio,
  MONTH(TO_DATE(bldat, 'YYYY-MM-DD')) AS mes,
  COUNT(*)                          AS registros
FROM STAGING_RD_HT_GT.SAP.COBK
WHERE TO_DATE(bldat, 'YYYY-MM-DD') >= TO_DATE('2024-01-01', 'YYYY-MM-DD')
  AND TO_DATE(bldat, 'YYYY-MM-DD') <  TO_DATE('2025-12-31', 'YYYY-MM-DD')
GROUP BY
  YEAR(TO_DATE(bldat, 'YYYY-MM-DD')),
  MONTH(TO_DATE(bldat, 'YYYY-MM-DD'))
ORDER BY anio, mes;

SELECT * FROM STAGING_RD_HT_GT.SAP.COBK
WHERE BELNR = '0100014567'
AND KOKRS = '2100'; 

SELECT BUDAT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.COBK
WHERE BUDAT BETWEEN '2024-01-01' AND '2025-12-31'
GROUP BY BUDAT
ORDER BY BUDAT ASC;

SELECT AUGDT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.BSEG
WHERE AUGDT BETWEEN '2024-01-01' AND '2025-12-31'
GROUP BY AUGDT
ORDER BY AUGDT ASC;

SELECT 
    COLUMN_NAME,
    DATA_TYPE
FROM STAGING_RD_HT_GT.INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = 'SAP'
  AND TABLE_NAME = 'BSEG';

SELECT CPUDT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.MKPF
WHERE CPUDT BETWEEN '2024-01-01' AND '2025-12-31'
GROUP BY CPUDT
ORDER BY CPUDT ASC;

SELECT ERDAT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.LIPS
WHERE ERDAT BETWEEN '2024-01-01' AND '2025-12-31'
GROUP BY ERDAT
ORDER BY ERDAT ASC;
-- SE TIENE QUE REPROCESR 
DELETE FROM STAGING_RD_HT_GT.SAP.LIPS
WHERE ERDAT >= '2025-10-01'
;

SELECT COUNT(*) FROM STAGING_RD_HT_GT.SAP.LIPS
-- 203 906 412
; 

SELECT ERDAT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.VBAK
WHERE ERDAT BETWEEN '2024-01-01' AND '2025-12-31'
GROUP BY ERDAT
ORDER BY ERDAT ASC;

DELETE FROM STAGING_RD_HT_GT.SAP.VBAK
WHERE ERDAT >= '2025-09-01'
; 

SELECT ERDAT, COUNT(*)
FROM STAGING_RD_HT_GT.SAP.VBAP
WHERE ERDAT BETWEEN '2024-01-01' AND '2025-12-31'
GROUP BY ERDAT
ORDER BY ERDAT ASC;

DELETE FROM STAGING_RD_HT_GT.SAP.VBAP
WHERE ERDAT IN (
'2025-01-28',
'2025-05-07',
'2025-08-11',
'2025-08-12',
'2025-08-20',
'2025-08-21',
'2025-08-27'
)
; 